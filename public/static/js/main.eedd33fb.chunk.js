(window["webpackJsonpscreen-share"]=window["webpackJsonpscreen-share"]||[]).push([[0],{124:function(e,t){},126:function(e,t){},155:function(e,t){},158:function(e,t,n){},164:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(14),s=n.n(o),c=(n(94),n(9)),i=n.n(c),l=n(19),u=n(36),d=n(67),m=n(82),p=n(68),h=n(83),v=n(69),g=n.n(v),f=n(70),S=n.n(f),k=window.location.origin,w=[{urls:"stun:stun.schlund.de"},{urls:"stun:stun.sipgate.net"},{urls:"stun:217.10.68.152"},{urls:"stun:stun.sipgate.net:10000"},{urls:"stun:217.10.68.152:10000"},{url:"turn:numb.viagenie.ca",username:"y.alanyali@gmail.com",credential:"testserver",credentialType:"password"},{urls:"turn:192.155.84.88",username:"easyRTC",credential:"easyRTC@pass",credentialType:"password"},{urls:"turn:192.155.84.88?transport=tcp",username:"easyRTC",credential:"easyRTC@pass",credentialType:"password"},{urls:"turn:192.155.86.24:443",credential:"easyRTC@pass",username:"easyRTC",credentialType:"password"},{urls:"turn:192.155.86.24:443?transport=tcp",credential:"easyRTC@pass",credentialType:"password",username:"easyRTC"}],y=function e(t,n,a){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(u.a)(this,e),this.socket=S()(k),this.signalClient=new g.a(this.socket,{connectionTimeout:5e3}),this.hostPeer=null,this.signalClient.once("discover",function(){var e=Object(l.a)(i.a.mark((function e(t){var n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=20;break}if(!t){e.next=17;break}return e.prev=2,e.next=5,r.signalClient.connect(o,{socketId:r.socket.id},{config:{iceServers:w}});case 5:n=e.sent,s=n.peer,console.log("Connected to the peer:",s),r.hostPeer=s,a(r.hostPeer),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("Error connecting to the peer:",e.t0);case 15:e.next=18;break;case 17:console.log("Peer is not online.");case 18:e.next=22;break;case 20:console.log("Hosted with id",r.signalClient.id),a(r.signalClient.id);case 22:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}()),this.signalClient.on("request",function(){var e=Object(l.a)(i.a.mark((function e(n){var a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.accept({},{config:{iceServers:w}});case 2:a=e.sent,r.socket.send({target:a.metadata.socketId,message:{socketId:r.socket.id}}),o={peer:a.peer,socketId:a.metadata.socketId},t(o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.socket.on("connect",(function(){r.signalClient.discover({targetPeer:o})})),this.socket.on("peer-disconnect",(function(e){n(e)})),this.socket.on("welcome",(function(e){r.hostPeer.socketId=e.socketId}))},E=(n(158),n(187)),b=n(184),C=n(185),T=n(189),P=n(186),A=n(79),O=n.n(A),x=n(81),I=n.n(x),j=n(80),R=n.n(j),L=n(188),B=n(73),D=n.n(B),M=n(72),N=n.n(M),F=n(75),H=n.n(F),U=n(74),z=n.n(U),J=n(77),_=n.n(J),W=n(76),q=n.n(W),V=n(78),Y=n.n(V),K=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).init=function(t){if("hoster"===t)return e.peerList=[],new y(e.handleNewPeer,e.handleDisconnectedPeerAsHoster,e.handleConnectedAsHoster,e.targetId);"joiner"===t&&(e.hostPeer=null,new y((function(){}),e.handleDisconnectedPeerAsJoiner,e.handleConnectedAsJoiner,e.targetId))},e.handleConnectedAsHoster=function(t){e.setState({roomId:t})},e.handleConnectedAsJoiner=function(t){t.on("stream",(function(t){console.log("Host shares a stream:",t),e.playStream(t)})),e.hostPeer=t,e.setState({connected:!0})},e.handleNewPeer=function(){var t=Object(l.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=n.peer).socketId=n.socketId,console.log("A peer connected:",a),a.on("stream",e.handlePeerStreamAsHoster(a)),e.sendStreamsToNewPeer(a),e.peerList.push(a),e.setState({connected:!0});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handlePeerStreamAsHoster=function(t){return function(n){e.isTrustedPeer(t)?e.playStream(n):console.log("A non-trusted peer started a stream.")}},e.handleDisconnectedPeerAsHoster=function(t){var n=e.peerList.length;e.peerList=e.peerList.filter((function(e){return e.socketId!==t})),e.peerList.length<n&&(console.log("A peer disconnected."),e.setState({connected:e.peerList.length>0}))},e.handleDisconnectedPeerAsJoiner=function(t){e.hostPeer.socketId===t&&(console.log("The host was disconnected from the server."),e.setState({connected:!1}))},e.sendStreamsToNewPeer=function(t){e.videoStream&&t.addStream(e.videoStream),e.audioStream&&t.addStream(e.audioStream)},e.updateStreamOnPeers=function(t,n,a){var r;r="video"===n?e.videoStream:e.audioStream,"hoster"===e.sessionType?e.peerList.forEach((function(e){r&&e.removeStream(r),a||e.addStream(t)})):"joiner"===e.sessionType&&(r&&e.hostPeer.removeStream(r),a||e.hostPeer.addStream(t))},e.isTrustedPeer=function(t){if("hoster"===e.sessionType){if(e.peerList.length>0)return e.peerList[0]._id===t._id}else if("joiner"===e.sessionType&&e.hostPeer)return e.hostPeer._id===t._id},e.toggleMic=Object(l.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.audioStream){t.next=10;break}return t.next=3,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 3:n=t.sent,e.setState({micActive:!0}),console.log("Created audio stream:",n),e.state.connected&&e.updateStreamOnPeers(n,"audio"),e.audioStream=n,t.next=15;break;case 10:e.updateStreamOnPeers(null,"audio",!0),e.audioStream.getTracks().forEach((function(e){return e.stop()})),e.audioStream=null,e.setState({micActive:!1}),console.log("Removed audio stream.");case 15:case"end":return t.stop()}}),t)}))),e.toggleCam=Object(l.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.screenShareActive&&e.toggleScreenShare(),null!==e.videoStream){t.next=11;break}return t.next=4,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 4:n=t.sent,e.setState({camActive:!0}),console.log("Created video stream (Webcam):",n),e.state.connected&&e.updateStreamOnPeers(n,"video"),e.videoStream=n,t.next=16;break;case 11:e.updateStreamOnPeers(null,"video",!0),e.videoStream.getTracks().forEach((function(e){return e.stop()})),e.videoStream=null,e.setState({camActive:!1}),console.log("Removed video stream (Webcam).");case 16:case"end":return t.stop()}}),t)}))),e.toggleScreenShare=Object(l.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.camActive&&e.toggleCam(),null!==e.videoStream){t.next=11;break}return t.next=4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});case 4:n=t.sent,e.setState({screenShareActive:!0}),console.log("Created video stream (Screen):",n),e.state.connected&&e.updateStreamOnPeers(n,"video"),e.videoStream=n,t.next=16;break;case 11:e.updateStreamOnPeers(null,"video",!0),e.videoStream.getTracks().forEach((function(e){return e.stop()})),e.videoStream=null,e.setState({screenShareActive:!1}),console.log("Removed video stream (Screen).");case 16:case"end":return t.stop()}}),t)}))),e.streamHasVideo=function(e){return e.getVideoTracks().length>0},e.playStream=function(t){e.streamHasVideo(t)?(e.refs.screen.srcObject=null,e.refs.screen.muted=!0,e.refs.screen.controls=!0,e.refs.screen.srcObject=t,e.refs.screen.load()):(console.log("SES"),e.refs.speaker.srcObject=null,e.refs.speaker.srcObject=t)},e.toggleFullScreen=function(){document.mozFullScreen||document.webkitFullScreen?document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen():e.refs.screen.mozRequestFullScreen?e.refs.screen.mozRequestFullScreen():e.refs.screen.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)},e.getShareUrl=function(){return e.state.roomId?window.location.hostname+"/"+e.state.roomId:"Creating your shareable link..."},e.copyUrl=function(){var t=e.refs.urlText.children[0],n=t.value;t.value="https://"+n,t.select(),document.execCommand("copy"),t.value=n,window.getSelection().removeAllRanges(),e.setState({snackOpen:!0},(function(){setTimeout((function(){e.setState({snackOpen:!1})}),1500)}))},e.isMobileDevice=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(navigator.userAgent||""),e.renderButtons=function(){var t={mic:r.a.createElement("div",{id:"micButton",onClick:e.toggleMic},e.state.micActive?r.a.createElement(L.a,null,r.a.createElement(N.a,null)):r.a.createElement(L.a,null,r.a.createElement(D.a,null))),screenShare:r.a.createElement("div",{id:"screenShareButton",onClick:e.toggleScreenShare},e.state.screenShareActive?r.a.createElement(L.a,null,r.a.createElement(z.a,null)):r.a.createElement(L.a,null,r.a.createElement(H.a,null))),camToggle:r.a.createElement("div",{id:"camToggleButton",onClick:e.toggleCam},e.state.camActive?r.a.createElement(L.a,null,r.a.createElement(q.a,null)):r.a.createElement(L.a,null,r.a.createElement(_.a,null))),fullScreen:r.a.createElement("div",{id:"fullScreenToggleButton",onClick:function(){e.toggleFullScreen()}},r.a.createElement(L.a,null,r.a.createElement(Y.a,null)))};return r.a.createElement("div",{className:"button-container"},navigator.mediaDevices.getUserMedia?t.mic:"",e.isMobileDevice?"":t.screenShare,navigator.mediaDevices.getUserMedia?t.camToggle:"",t.fullScreen)},e.state={roomId:"",connected:!1,micActive:!1,camActive:!1,screenShareActive:!1,snackOpen:!1},e.targetId=window.location.pathname.replace("/",""),e.sessionType=""!==e.targetId?"joiner":"hoster",e.videoStream=null,e.audioStream=null,e.init(e.sessionType),e}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"main-container"},r.a.createElement(b.a,{variant:"h3"},"Screen Share"),"hoster"===this.sessionType?r.a.createElement(C.a,{className:"url-container",onClick:this.copyUrl},r.a.createElement(L.a,{style:{fontSize:15,color:"gray"},disabled:!0},"Your URL:"),r.a.createElement(T.a,{ref:"urlText",style:{flex:1},value:this.getShareUrl(),readOnly:!0}),r.a.createElement(P.a,{style:{height:28,margin:4},orientation:"vertical"}),r.a.createElement(L.a,{style:{padding:10}},r.a.createElement(O.a,null))):this.state.connected?"":r.a.createElement(b.a,{variant:"h6",style:{marginTop:20,fontSize:16}},"Connecting..."),r.a.createElement("div",{className:"status-container"},this.state.connected?r.a.createElement(R.a,null):r.a.createElement(I.a,null),r.a.createElement(b.a,{variant:"h6",style:{marginLeft:5}},this.state.connected?"Connected":"Not Connected")),r.a.createElement("div",{className:"screen-container"},r.a.createElement("video",{id:"screen",ref:"screen",onCanPlay:function(e){e.target.play()}}),r.a.createElement("audio",{id:"speaker",ref:"speaker",onCanPlay:function(e){e.target.play()}})),this.renderButtons()),r.a.createElement(E.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:this.state.snackOpen,message:r.a.createElement("span",null,"Copied to clipboard!")}))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},89:function(e,t,n){e.exports=n(164)},94:function(e,t,n){}},[[89,1,2]]]);